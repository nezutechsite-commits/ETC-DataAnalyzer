# 【ETC】走行明細データ / 詳細補足情報データ解析ツール

## ツールの概要

今回作成したのは、NEXCO各社が公開しているETCの走行明細データおよび明細補足情報データを解析するWPFアプリケーションツールです。対象となるデータは、NEXCO各社が公開している以下のフォーマットのファイルです：
* 走行明細データ (OTMEISAI2)
* 明細補足情報 (OTINFO2)

ファイル詳細やフォーマットについては[NEXCO公式サイト](https://www.w-nexco.co.jp/etc/frequency/invoice/)をご参照ください。

このツールを使うことで、テキスト形式で提供される走行明細や補足データを、分析や集計に使いやすいCSV形式に変換することができます。ExcelやBIツールなどに取り込み、走行傾向や利用パターンを簡単に可視化・分析することが可能です。

## 主な機能
* 走行明細データの読み込み：NEXCOが提供するテキストファイルを読み込むことが可能
* 明細補足情報データの読み込み：同様にテキスト形式の補足情報ファイルをサポート
* CSV形式への変換：ExcelやPythonなどで扱いやすい形に整形
* GUI操作（WPF）：ファイル選択から変換まで直感的に利用可能

## 使い方
ETCの走行明細データと明細補足情報データを使用します。手元にない場合はサンプルデータが[公式サイト](https://www.w-nexco.co.jp/etc/frequency/invoice/)より公開されているのでそちらからダウンロードしてください。

1. ツールを起動します。
2. 「ソース元ファイル名」に走行明細データまたは明細補足情報データファイルを指定します。「参照」ボタン押下でファイルオープンダイアログを表示し、ファイルを指定することも可能です。
3. 「出力先フォルダ名」にCSVファイルを出力したい任意のフォルダを指定します。「参照」ボタン押下でフォルダオープンダイアログを表示し、フォルダを指定することも可能です。
4. 走行明細データを「ソース元ファイル名」に指定した場合、OTMEISAI2タブを選択します。明細補足情報データを「ソース元ファイル名」に指定した場合、OTINFO2タブを選択します。
5. 「CSV出力」ボタンを押すと、「出力先フォルダ名」に指定したフォルダにCSVファイルが出力されます。

## オプション機能
* エンコード：ソース元ファイルのエンコード（Shift-JIS / UTF-8）が指定可能です。走行明細データにはShift-JISコードの全角日本語文字が含まれているため、文字化けを防ぐためにshift-jisを選択してください。詳しくは公式サイトの[データ特約別表1データフォーマット](https://www.w-nexco.co.jp/etc/frequency/invoice/pdfs/05.pdf)をご参照ください。
* 新規登録：タブを追加し、新しいフォーマットのデータファイル解析に対応できます。仕様変更や独自データにも利用可能です。
* 削除：不要になったタブを削除可能です。
* ラベル名：タブの名称を任意に変更することができます。
* 表編集：データフォーマットに従ったフィールド名と桁数を編集することができます。デフォルトではOTINFO2とOTMEISAI2を用意しています。デフォルトのフォーマットについては[データ特約別表1データフォーマット](https://www.w-nexco.co.jp/etc/frequency/invoice/pdfs/05.pdf)に基づいています。
* 行の追加：表に行を追加します。表の上での右クリックで「上に追加」「下に追加」を選択して任意の箇所に行を挿入することができます。
* 行の削除：表の上で右クリックし、「削除」を選択することで行を削除することができます。
* 設定の保存：登録しているタブ内容をすべて保存できます。途中で設定内容を保存したい場合に便利です。
